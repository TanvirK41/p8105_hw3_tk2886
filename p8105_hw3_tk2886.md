p8105\_hw3\_tk2886
================

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──

    ## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
    ## ✓ tibble  3.1.4     ✓ dplyr   1.0.7
    ## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
    ## ✓ readr   2.0.1     ✓ forcats 0.5.1

    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(patchwork)
library(p8105.datasets)

## Set Global Options 
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6, 
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

Loading Data and Cleaning Data with janitor

``` r
data("instacart")

instacart_df <- 
  instacart %>% 
  janitor::clean_names()
```

Analysis of instacart data

``` r
dimension_instacart = dim(instacart_df)
dimension_instacart
```

    ## [1] 1384617      15

``` r
instacart_row = nrow(instacart_df)
instacart_row
```

    ## [1] 1384617

``` r
instacart_col = ncol(instacart_df)
instacart_col
```

    ## [1] 15

``` r
key_variables = names(instacart_df)
key_variables
```

    ##  [1] "order_id"               "product_id"             "add_to_cart_order"     
    ##  [4] "reordered"              "user_id"                "eval_set"              
    ##  [7] "order_number"           "order_dow"              "order_hour_of_day"     
    ## [10] "days_since_prior_order" "product_name"           "aisle_id"              
    ## [13] "department_id"          "aisle"                  "department"

The dimension of the instacart dataframe is 1384617, 15. The dimensions
represents the number of rows and the columns. The number of rows in the
instacart dataframe are 1384617. The number of columns in the instacart
dataframe are 15.

Analyzing the Aisle Column/Variable and arranging most aisles with the
most

``` r
aisle_analysis <- instacart_df %>%
  group_by(aisle) %>%
  summarise(n_obs = n()) %>%
  arrange(desc(n_obs))
```

After analyzing the data frame, there are **134 aisles**.

Filtering the aisles with more than 10000 items ordered.

``` r
aisle_filter <- 
  instacart_df %>%
  group_by(aisle) %>%
  summarise(aisle_n = n()) %>%
  filter(aisle_n > 10000) %>%
  ggplot(aes(x = reorder(aisle, aisle_n), y = aisle_n)) +
  geom_bar(stat = "identity") + 
  labs(
    title = "Number of items ordered in each Aisle",
    x = "Aisle Identification",
    y = "Quantitiy purchased from each Aisle",
    caption = "Data from the Instacart package"
  ) + 
  coord_flip()
```

Creating A table showing the three most popular items in each of the
aisles “baking ingredients”, “dog food care”, and “packaged vegetables
fruits”.

``` r
inst_table1 <- instacart_df %>%
  filter(aisle %in%  c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>%
  group_by(aisle, product_name) %>%
  summarise(Product_Quantity = n()) %>%
  top_n(3, wt = Product_Quantity) %>%
  arrange(aisle, desc(Product_Quantity)) %>%
  knitr::kable()
```

    ## `summarise()` has grouped output by 'aisle'. You can override using the `.groups` argument.
